# 网络

## `Keep-Alive`模式，客户端如何判断请求所得到的响应数据已经接收完成（或者说如何知道服务器已经发生完了数据）？

[HTTP Keep-Alive模式,客户端如何判断服务器的数据已经发生完成](https://www.zhoulujun.cn/html/webfront/SGML/web/2015_1016_318.html)

使用消息首部字段`Conent-Length`：`Conent-Length`表示实体内容长度，客户端（服务器）可以根据这个值来判断数据是否接收完成。

使用消息首部字段`Transfer-Encoding`：当客户端向服务器请求一个静态页面或者一张图片时，服务器可以很清楚的知道内容大小，然后通过`Content-length`消息首部字段告诉客户端需要接收多少数据。

但是如果是动态页面等时，服务器是不可能预先知道内容大小，这时就可以使用`Transfer-Encoding`：`chunk`模式来传输数据了。即如果要一边产生数据，一边发给客户端，服务器就需要使用`Transfer-Encoding: chunked`这样的方式来代替`Content-Length`。

`chunk`编码将数据分成一块一块的发生。`Chunked`编码将使用若干个`Chunk`串连而成，由一个标明长度为`0`的`chunk`标示结束。每个`Chunk`分为头部和正文两部分，头部内容指定正文的字符总数（十六进制的数字）和数量单位（一般不写），正文部分就是指定长度的实际内容，两部分之间用回车换行(`CRLF`)隔开。在最后一个长度为`0`的`Chunk`中的内容是称为`footer`的内容，是一些附加的`Header`信息（通常可以直接忽略）。

## `TCP`和`UDP`的特点，`TCP`三次握手、四次挥手，`TCP`连接、断开时一些标志位的改变

[TCP协议](https://github.com/JasonJe/full-stack-notes/blob/master/Python%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B.md#133-tcp%E5%8D%8F%E8%AE%AE)

[UDP协议](https://github.com/JasonJe/full-stack-notes/blob/master/Python%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B.md#134-udp%E5%8D%8F%E8%AE%AE)

## 在浏览器中输入一个网站，发生的事情

[从输入URL到打开网页](https://github.com/JasonJe/full-stack-notes/blob/master/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/%E4%BB%8E%E8%BE%93%E5%85%A5URL%E5%88%B0%E6%89%93%E5%BC%80%E7%BD%91%E9%A1%B5.md)

## `HTTPS`和`HTTP`的区别，`HTTPS`属于哪个端口，`FTP`呢

`HTTPS`和`HTTP`的区别主要如下：

- 1) `https`协议需要到`ca`申请证书，一般免费证书较少，因而需要一定费用。

- 2) `http`是超文本传输协议，信息是明文传输，`https`则是具有安全性的`ssl`加密传输协议。

- 3) `http`和`https`使用的是完全不同的连接方式，用的端口也不一样，前者是`80`，后者是`443`。

- 4) `http`的连接很简单，是无状态的；`HTTPS`协议是由`SSL+HTTP`协议构建的可进行加密传输、身份认证的网络协议，比`http`协议安全。

[HTTP协议](https://github.com/JasonJe/full-stack-notes/blob/master/Python%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B.md#135-http%E5%8D%8F%E8%AE%AE)

[FTP和SMTP协议](https://github.com/JasonJe/full-stack-notes/blob/master/Python%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B.md#136-ftp%E5%92%8Csmtp%E5%8D%8F%E8%AE%AE)

## `RESTful`概念

[理解RESTful架构](http://www.ruanyifeng.com/blog/2011/09/restful.html)

[RESTful API 设计指南](http://www.ruanyifeng.com/blog/2014/05/restful_api.html)

## `XML/JSON/Protobuf` 网络通信技术数据交换格式

- 1) `JSON`：键值对，轻量级的数据交换格式，具有良好的可读和便于快速编写的特性。 

- 2) `XML`： 在`WebService`中应用最为广泛，但是相比于`JSON`，它的数据更加冗余，因为需要成对的闭合标签。

- 3) `Protobuf`：谷歌开源的一种数据格式，适合高性能，对响应速度有要求的数据传输场景。因为`Protobuf`是二进制数据格式，需要编码和解码。数据本身不具有可读性。因此只能反序列化之后得到真正可读的数据。

`Protobuf`优势：

- 1) 序列化后体积相比`JSON`和`XML`很小，适合网络传输；

- 2) 支持跨平台多语言；

- 3) 消息格式升级和兼容性还不错；

- 4) 序列化反序列化速度很快，快于Json的处理速度。

## `Web Server` 性能调优、大规模并发、缓存机制

[分布式、高并发、多线程，到底有什么区别？](https://www.toutiao.com/i6658590265218957836/?tt_from=weixin&utm_campaign=client_share&wxshare_count=1&timestamp=1552700876&app=news_article&utm_source=weixin&utm_medium=toutiao_android&group_id=6658590265218957836)

## `cookie` 和 `session` 的用法和区别 

- 1) `session` 保存在服务器端，`cookie` 保存在客户端；

- 2) `session` 的运行依赖 `session id`，而 `session id` 是存在 `cookie` 中的，也就是说，如果浏览器禁用了 `cookie` ，同时 `session` 也会失效（但是可以通过其它方式实现，比如在 `url` 中传递 `session_id`）；

- 4) `cookie`可以跟踪会话，也可以保存用户喜好或者保存用户名密码；`session`用来跟踪会话。

## `TCP`的拥塞控制，具体过程是怎么样的？`UDP`有拥塞控制吗？如何解决？

在某段时间，若对网络中某资源的需求超过了该资源所能提供的可用部分，网络的性能就要变坏，即产生拥塞(`congestion`)。

* `TCP`

TCP的拥塞控制`4`部分组成：慢启动（`slow start`）、拥塞避免（`Congestion voidance`）、快速重传（`Fast Retransmit`）和快速恢复（`Fast Recovery`）。

基于**滑动窗口**的流量控制机制：拥塞控制，在发送方维持着一个拥塞窗口`CWND`（`congestion window`）的状态量。拥塞窗口的大小取决于网络的拥塞程度，并且动态的变化。发送方让自己的发送窗口等于拥塞窗口，另外考虑到接收方的接收能力，发送窗口可能小于拥塞窗口。

[网络基本功：TCP拥塞控制机制](https://blog.csdn.net/gogokongyin/article/details/51287985)

新建立的连接不能够一开始就大量发送数据包，而是根据网络情况逐步增加每次发送的数量。

慢启动（`slow start`）：为防止`CWND`增长过大引起网络阻塞，设置慢开始门限`ssthresh`状态变量选择慢开始算法与拥塞避免算法。

拥塞避免（`Congestion voidance`）：拥塞窗口缓慢增长，每经过一个往返时间`RTT`就把发送发的拥塞窗口`+1`，而不是加倍。

快速重传（`Fast Retransmit`）：接收方在收到一个失序的报文段后立即发出重复确认，发送方只要收到三个重复确认就应当立即重传尚未收到的报文段，不必等待设置的重传计时器时间到期。

快速恢复（`Fast Recovery`）：发送方收到三个重复确认时，`ssthresh`门限减半，然后执行拥塞避免算法。

* `UDP`

实现可靠传输：超时重传（定时器）、有序接受 （添加包序号）、应答确认 （`Seq/Ack`应答机制）、滑动窗口流量控制等机制 （滑动窗口协议）等。

等于说要在传输层的上一层（或者直接在应用层）实现`TCP`协议的可靠数据传输机制，比如使用`UDP数据包+序列号`，`UDP数据包+时间戳`等方法。

目前已经有一些实现`UDP`可靠传输的机制，比如`UDT`。

## `CDN`是什么

`CDN`的全称是`Content Delivery Network`，即内容分发网络。`CDN`是构建在网络之上的内容分发网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。`CDN`的关键技术主要有内容存储和分发技术。

## `HTTP`的多路复用

`HTTP/2`有三大特性：头部压缩、`Server Push`、多路复用。

`Keep-Alive`解决的核心问题：一定时间内，同一域名多次请求数据，只建立一次`HTTP`请求，其他请求可复用每一次建立的连接通道，以达到提高请求效率的问题。

`HTTP/2`引入二进制数据帧和流的概念，其中帧对数据进行顺序标识，浏览器利用帧对数据进行合并，这样数据就能并行传输了。

`HTTP/2`对同一域名下所有请求都是基于流，也就是说同一域名不管访问多少文件，也只建立一路连接。

## `HTTP`协议常用头部

[HTTP协议常用头部实例详解（Request、Response）](https://blog.csdn.net/selinda001/article/details/79338766)

## `RPC`过程，服务注册中心宕机了怎么办？